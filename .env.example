# =============================================================================
# Freshly Backend Environment Configuration
# =============================================================================
# Copy this file to .env and fill in your actual values
# NEVER commit .env to version control!

# -----------------------------------------------------------------------------
# Application Settings
# -----------------------------------------------------------------------------
APP_NAME="Freshly API"
APP_ENV=local  # local, development, staging, production
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
DEBUG=false

# -----------------------------------------------------------------------------
# Database Configuration (Supabase PostgreSQL)
# -----------------------------------------------------------------------------
# Direct connection URL (for migrations and non-pooled operations)
DATABASE_URL="postgresql://user:password@host:5432/database?sslmode=require"

# Pooler connection URL (for API operations to avoid MaxClientsInSessionMode errors)
DATABASE_URL_POOLER="postgresql://user.project:password@host.pooler.supabase.com:5432/database?sslmode=require"

# Database Pool Settings (not used with NullPool, kept for backward compatibility)
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=30
DATABASE_POOL_TIMEOUT=30

# -----------------------------------------------------------------------------
# Security & Authentication
# -----------------------------------------------------------------------------
# JWT Secret (generate with: python -c "import secrets; print(secrets.token_urlsafe(32))")
JWT_SECRET=your-secret-key-here-generate-with-command-above
JWT_ALG=HS256

# Token Expiration Settings (in minutes/days)
ACCESS_TOKEN_EXPIRE_MINUTES=30  # Short-lived access tokens (30 mins recommended)
REFRESH_TOKEN_EXPIRE_DAYS=7     # Refresh token validity (7 days recommended)

# Secret Key for other operations
SECRET_KEY=your-secret-key-here

# -----------------------------------------------------------------------------
# Redis Configuration (Required for token blacklisting & caching)
# -----------------------------------------------------------------------------
# Get Redis URL from Upstash or your Redis provider
REDIS_URL=rediss://default:password@your-redis-host:6379
CACHE_TTL_SECONDS=300  # Default cache TTL (5 minutes)

# -----------------------------------------------------------------------------
# CORS Configuration
# -----------------------------------------------------------------------------
# JSON array format for allowed origins
CORS_ORIGINS='["http://localhost:3000","http://127.0.0.1:3000"]'
ALLOWED_HOSTS=*  # Use specific hosts in production

# -----------------------------------------------------------------------------
# Email Configuration (Gmail SMTP)
# -----------------------------------------------------------------------------
MAIL_USERNAME=your-email@gmail.com
MAIL_PASSWORD=your-app-specific-password  # Generate at: https://myaccount.google.com/apppasswords
MAIL_FROM=your-email@gmail.com
MAIL_PORT=587
MAIL_SERVER=smtp.gmail.com
MAIL_FROM_NAME="Freshly Team"
MAIL_STARTTLS=true
MAIL_SSL_TLS=false

# -----------------------------------------------------------------------------
# Supabase Configuration (for OAuth & file storage)
# -----------------------------------------------------------------------------
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_SERVICE_ROLE=your-service-role-key-here
AVATARS_BUCKET=users  # Bucket name for user avatars

# -----------------------------------------------------------------------------
# OpenAI Configuration (for AI features)
# -----------------------------------------------------------------------------
OPENAI_API_KEY=sk-proj-your-openai-api-key-here
OPENAI_MAX_TOKENS=1000
OPENAI_TEMPERATURE=0.7

# -----------------------------------------------------------------------------
# API Rate Limiting
# -----------------------------------------------------------------------------
RATE_LIMIT_REQUESTS=100  # Requests per window
RATE_LIMIT_WINDOW=60     # Window in seconds
AUTH_RATE_LIMIT=10       # Auth-specific rate limit

# -----------------------------------------------------------------------------
# File Upload Settings
# -----------------------------------------------------------------------------
MAX_FILE_SIZE=10485760  # 10MB in bytes
ALLOWED_FILE_TYPES="image/jpeg,image/png,image/webp"

# -----------------------------------------------------------------------------
# Security Notes
# -----------------------------------------------------------------------------
# 1. Generate strong JWT_SECRET: python -c "import secrets; print(secrets.token_urlsafe(32))"
# 2. Use app-specific passwords for Gmail (not your account password)
# 3. Keep ACCESS_TOKEN_EXPIRE_MINUTES short (15-30 mins) for security
# 4. Use REFRESH_TOKEN_EXPIRE_DAYS for long-lived sessions (7 days recommended)
# 5. Redis is REQUIRED for token blacklisting and refresh token rotation
# 6. Never commit the .env file to version control
# 7. Update CORS_ORIGINS to only include your production domains
# 8. Set APP_ENV=production in production environments
